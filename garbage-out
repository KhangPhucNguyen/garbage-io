#!/bin/bash

. garbage-conf
target="${1:-.}"
#find "$target" -type f -mtime +7 -exec rm {} \;

cur_size="$(du -s "$target" | awk '{print $1}')"
if [[ "$cur_size" -gt "$limit_size" ]]
then
    find "$target" -type f -regextype sed -regex ".*.$stamp-[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}_[0-9]\{2\}-[0-9]\{2\}-[0-9]\{2\}"
fi

find "$target" -type d -empty -exec rmdir {} \;
